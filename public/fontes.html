<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fontes de Dados - SNIIC</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #0a0e27;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
        }

        #container {
            position: absolute;
            inset: 0;
        }

        .header {
            position: fixed;
            top: 1rem;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 100;
            pointer-events: none;
        }

        .header h1 {
            font-size: 1.8rem;
            color: #667eea;
        }

        .header p {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .back-button {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 0.6rem 1.2rem;
            background: rgba(102, 126, 234, 0.25);
            border: 2px solid rgba(102, 126, 234, 0.5);
            border-radius: 8px;
            color: white;
            text-decoration: none;
            font-weight: 600;
            z-index: 101;
            transition: all .3s;
        }

        .back-button:hover {
            background: rgba(102, 126, 234, 0.45);
            transform: translateY(-2px);
        }

        .label {
            position: absolute;
            font-size: 11px;
            font-weight: 600;
            padding: 5px 10px;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            white-space: nowrap;
            pointer-events: none;
            user-select: none;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
        }
    </style>
    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://cdn.jsdelivr.net/npm/@google/genai/+esm",
    "lit": "https://cdn.jsdelivr.net/npm/lit@3/+esm"
  }
}
</script>
</head>

<body>
    <div id="container"></div>

    <div class="header">
        <h1>üåê Fontes de Dados - SNIIC</h1>
        <p>Arraste para rotacionar ‚Ä¢ Scroll para zoom</p>
    </div>

    <a href="index.html" class="back-button">‚Üê Voltar</a>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        let scene, camera, renderer;
        let nodes = [];

        const fontes = {
            estruturantes: [
                'TransfereGov', 'SIAFI', 'SIAPE', 'SIOP', 'ComprasGov', 'SIORG',
                'SICONV', 'SIAFEM', 'SCDP', 'SEI', 'SIGEPE', 'CADIN', 'Portal Transpar√™ncia'
            ],
            finalisticos: [
                'SALIC', 'SNC/SNIIC', 'Sist. Nacional Cultura', 'Editais', 'Cad. Agentes',
                'Cad. Proponentes', 'Pontos Cultura', 'Cultura Viva', 'Aldir Blanc',
                'Paulo Gustavo', 'PNAB', 'Prest. Contas', 'Monitor. Projetos'
            ],
            abertos: [
                'dados.gov.br', 'APIs Gov.', 'CSV/XLSX', 'JSON/XML',
                'Microdados', 'S√©ries Hist.', 'GeoJSON', 'Shapefiles', 'Dados Agregados'
            ],
            documentais: [
                'PDFs Editais', 'Portarias', 'INs', 'Pareceres', 'Rel. Execu√ß√£o',
                'Rel. Gest√£o', 'Atas', 'Resolu√ß√µes', 'Planos Nacionais',
                'Prest. Contas Docs', 'DOU-MinC'
            ]
        };

        const cores = {
            estruturantes: 0xe74c3c,
            finalisticos: 0xf39c12,
            abertos: 0x3498db,
            documentais: 0x9b59b6,
            sniic: 0x2ecc71
        };

        init();

        function init() {
            scene = new THREE.Scene();

            camera = new THREE.PerspectiveCamera(
                75, window.innerWidth / window.innerHeight, 0.1, 1000
            );
            camera.position.set(0, 0, 90);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setClearColor(0x0a0e27);
            document.getElementById('container').appendChild(renderer.domElement);

            scene.add(new THREE.AmbientLight(0xffffff, 0.6));
            const light = new THREE.PointLight(0x667eea, 2, 200);
            light.position.set(50, 50, 50);
            scene.add(light);

            setupControls();
            createSNIIC();
            createSourceNodes();

            window.addEventListener('resize', onResize);
            animate();
        }

        function createSNIIC() {
            const geo = new THREE.SphereGeometry(5, 32, 32);
            const mat = new THREE.MeshPhongMaterial({
                color: cores.sniic,
                emissive: cores.sniic,
                emissiveIntensity: 0.7
            });
            const sniic = new THREE.Mesh(geo, mat);
            scene.add(sniic);

            sniic.userData.label = createLabel('SNIIC');
            nodes.push({ sphere: sniic, speed: 0 });
        }

        function createSourceNodes() {
            const radius = 55;

            Object.keys(fontes).forEach(cat => {
                fontes[cat].forEach(name => {

                    const phi = Math.acos(1 - 2 * Math.random());
                    const theta = Math.random() * Math.PI * 2;

                    const x = radius * Math.sin(phi) * Math.cos(theta);
                    const y = radius * Math.cos(phi);
                    const z = radius * Math.sin(phi) * Math.sin(theta);

                    const line = new THREE.Line(
                        new THREE.BufferGeometry().setFromPoints([
                            new THREE.Vector3(0, 0, 0),
                            new THREE.Vector3(x, y, z)
                        ]),
                        new THREE.LineBasicMaterial({
                            color: cores[cat],
                            transparent: true,
                            opacity: 0.4
                        })
                    );
                    scene.add(line);

                    const sphere = new THREE.Mesh(
                        new THREE.SphereGeometry(1.1, 16, 16),
                        new THREE.MeshPhongMaterial({
                            color: cores[cat],
                            emissive: cores[cat],
                            emissiveIntensity: 0.6
                        })
                    );
                    sphere.position.set(x, y, z);
                    sphere.userData.label = createLabel(name);
                    scene.add(sphere);

                    nodes.push({
                        sphere,
                        angle: Math.random() * Math.PI * 2,
                        speed: 0.0008 + Math.random() * 0.001
                    });
                });
            });
        }

        function createLabel(text) {
            const div = document.createElement('div');
            div.className = 'label';
            div.textContent = text;
            document.body.appendChild(div);
            return div;
        }

        function updateLabel(obj) {
            const v = obj.position.clone().project(camera);
            const x = (v.x * 0.5 + 0.5) * window.innerWidth;
            const y = (-v.y * 0.5 + 0.5) * window.innerHeight;
            obj.userData.label.style.left = `${x}px`;
            obj.userData.label.style.top = `${y}px`;
            obj.userData.label.style.display = v.z < 1 ? 'block' : 'none';
        }

        function animate() {
            requestAnimationFrame(animate);

            scene.rotation.y += 0.001;

            nodes.forEach(n => {
                if (n.speed) {
                    n.angle += n.speed;
                    n.sphere.position.applyAxisAngle(
                        new THREE.Vector3(0, 1, 0), n.speed * 2
                    );
                }
                updateLabel(n.sphere);
            });

            renderer.render(scene, camera);
        }

        function setupControls() {
            let dragging = false, px = 0, py = 0;

            renderer.domElement.addEventListener('mousedown', e => {
                dragging = true; px = e.clientX; py = e.clientY;
            });
            window.addEventListener('mouseup', () => dragging = false);

            window.addEventListener('mousemove', e => {
                if (!dragging) return;
                scene.rotation.y += (e.clientX - px) * 0.005;
                scene.rotation.x += (e.clientY - py) * 0.005;
                px = e.clientX; py = e.clientY;
            });

            window.addEventListener('wheel', e => {
                camera.position.z = THREE.MathUtils.clamp(
                    camera.position.z + e.deltaY * 0.05, 40, 150
                );
            });
        }

        function onResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
    </script>
    <div id="voice-assistant-root">
        <gdm-live-audio></gdm-live-audio>
    </div>
    <script type="module" src="voice-assistant.js"></script>
</body>

</html>